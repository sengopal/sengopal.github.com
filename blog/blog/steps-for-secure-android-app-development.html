<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Steps for secure Android Application development</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Senthilkumar Gopal blog and home page">
  <meta name="author" content="Senthilkumar Gopal">
  <meta name="keywords" content="Senthilkumar, gopal, sengopal">
  <meta name="generator" content="blog posts using github and jbake">
  <meta name="google-site-verification" content="GIVzIWlO9n9IHKF6iiiq19Js1HtsNlIGtyuNhWAcido" />
  <link rel="me" href="https://twitter.com/sengopal">
  <link rel="me" href="https://github.com/msengopal">
  <link rel="me" href="https://plus.google.com/+sengopal">
  <link rel="author" href="https://plus.google.com/+sengopal?rel=author">

  <link href="../css/font-awesome.min.css" rel="stylesheet">
  <link href="../css/screen.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="../js/html5shiv.min.js"></script>
  <![endif]-->

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
  <link rel="icon" href="../favicon.ico" type="image/x-icon">
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67843911-1', 'auto');
  ga('send', 'pageview');
  ga('create', 'UA-68428477-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
	<body onload="prettyPrint()">
    <div id="wrap">
			<div class="container">
<div class="header">
  <h1><a href="http://sengopal.github.io">Senthilkumar Gopal</a></h1>
  <h2>thoughts, code, ramblings and notes</h2>
  <ul class="external">
    <li><a href="https://medium.com/@sengopal/" target="_blank"><i class="fa fa-medium hvr-grow-rotate"></i></a></li>
    <li><a href="http://github.com/sengopal" target="_blank"><i class="fa fa-github-alt hvr-grow-rotate"></i></a></li>
    <li><a href="https://twitter.com/sengopal" target="_blank"><i class="fa fa-twitter hvr-grow-rotate"></i></a></li>
    <li><a href="https://www.linkedin.com/in/senthilkumargopal" target="_blank"><i class="fa fa-linkedin hvr-grow-rotate"></i></a></li>
    <li><a href="../feed.xml"><i class="fa fa-rss hvr-grow-rotate"></i></a></li>
  </ul>

</div>

<div class="nav" role="navigation">
  <ul>
    <li><a href="../archive.html">Posts</a></li>
    <li><a href="../pages/projects.html">Projects</a></li>
    <li><a href="https://github.com/sengopal/sengopal.github.com/raw/master/senthilkumar_gopal_resume.pdf">Resume</a></li>
    <!--
    <li><a href="../pages/reviews.html">Reviews</a></li>
    -->
  </ul>
</div>
				<div class="page-header">
					<h1>Steps for secure Android Application development</h1>
				</div>
				<p><em>22 March 2015</em></p>
				<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In a recent working session, some of the best practices for a secure Android application development were discussed. Following were some of the important aspects of the discussion. Other the usual standards of securing the APK and securing the server-side components, some of the development and secure coding practices are listed in this post. Its the responsibility of every Android app developer to keep themselves appraised about new threats using OWASP Mobile Top 10 Risks.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_classification_and_handling_standards">Data classification and Handling Standards</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>All data persisted should be encrypted - sqlliteDB, files, dataprovider etc.,</p>
</li>
<li>
<p>Don&#8217;t transmit sensitive data to unapproved 3rd party.</p>
</li>
<li>
<p>Don&#8217;t put sensitive data into Intents</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_mobile_privacy">Mobile privacy</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Respect user&#8217;s privacy by collecting minimum amount of data</p>
</li>
<li>
<p>GPS &amp; location data - fine grain vs. coarse grain GPS data</p>
</li>
<li>
<p>Contact Info</p>
</li>
<li>
<p>Microphone and Camera use</p>
</li>
<li>
<p>Tracking and Analytics IDs</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_attack_surface_analysis">Attack Surface Analysis</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Third party code automatically inherits app permissions. Treat new versions of library as a new version of your app.</p>
</li>
<li>
<p>Use Google Alerts for any security disclosures regarding the 3rd party library.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_securing_logs">Securing logs</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Do not enable crash logs by default. Get user consent before logging.</p>
</li>
<li>
<p>Do not store crash logs for too long</p>
</li>
<li>
<p>Do not send plain-text logs over HTTP</p>
</li>
<li>
<p>Mask sensitive user information in the logs - starbucks usecase</p>
</li>
<li>
<p>Minimize the number of permissions - dont ask for what you dont need - Incoming SMS messages -</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_securing_intents">Securing Intents</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use PendingIntents as delayed callbacks to private Broadcast receivers</p>
</li>
<li>
<p>Use Explicit intents as much as possible</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">context.sendBroadcast(intent,"custom-permission");
context.startActivity(intent);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_permissions_and_intents">Permissions and Intents</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use custom permission for 3rd party or other apps to subscribe for notifications</p>
</li>
<li>
<p>For sensitive activities, set FLAG_SECURE constant flag in WindowManager.LayoutParams</p>
</li>
<li>
<p>Perform intent data validation</p>
</li>
<li>
<p>For private activities, use explicit intent</p>
</li>
<li>
<p>Seperate services in AndroidManifest with explicit and seperate permissions</p>
</li>
<li>
<p>Use explicit intent to call Service</p>
</li>
<li>
<p>Use <code>checkCallingPermission()</code> to verify if permission is available to the caller</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_data_security">Data Security</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use record level delegation feature to share a specific record or file without sharing the entire database to provide minimum access.</p>
</li>
<li>
<p>Never trust the parameters passed to content providers. Sanatize for injection attacks.</p>
</li>
<li>
<p>Securing ContentProviders. Always set <code>exported=false</code> in your <strong>AndroidManifest.xml</strong></p>
</li>
<li>
<p>Ppecify explicit permissions for reading and writing.</p>
</li>
<li>
<p>Use dynamic <code>grantUriPermissions</code> attribute to true to grant permission for certain portion for certain amount of time.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_webview_security">WebView Security</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable JS and Plugin support if not needed</p>
</li>
<li>
<p>No local file access</p>
</li>
<li>
<p>Do not load 3rd party hosts unless validated</p>
</li>
<li>
<p>Do not follow redirect requests in the server response unless validated</p>
</li>
<li>
<p>If possible, use only https</p>
</li>
<li>
<p>Disable form auto-fill feature by using <code>WebView.WebSettings.setSaveFormData()</code> as false</p>
</li>
<li>
<p>Reject unexpected content - only allow HTML for main page (reject PDFs etc.,)</p>
</li>
<li>
<p>Secure Page Rendering in WebView  - shouldOverrideUrlLoading</p>
</li>
<li>
<p>Access Modifiers should not be trusted for sensitivity.</p>
</li>
<li>
<p>Clear the cache after Webview of a Sensitive page.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">onPageFinished(Webview view, String Url){
    view.clearCache(true);
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that UI Redressing (a.k.a) Tap jacking protection is setup to prevent click jacking Use <code>setFilterTouchesWhenObscured(true)</code> or android:setFilterTouchesWhenObscured for activity declaration.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_development_practices">Development practices</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Keep sensitive data in RAM no longer than required such as Encryption keys, Authn, Authz tokens, passwords.</p>
</li>
<li>
<p>Variables should be nullified after use</p>
</li>
<li>
<p>Use byte[] and char[] for sensitive data rather than Strings which helps in cleaning easier.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_internal_storage">Internal Storage</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Accessible only to your app</p>
</li>
<li>
<p>clean the cache using deleteFile()</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_external_storage">External Storage</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Globally readable and writable</p>
</li>
<li>
<p>Can be physically removed</p>
</li>
<li>
<p>Avoid using this storage for sensitive apps in general. Use <code>preferInternal</code> to prevent app being installed in external storage.</p>
</li>
<li>
<p>Use Keychain API for system wide credentials</p>
</li>
<li>
<p>Use Keystore to stores its own credentials</p>
</li>
<li>
<p><code>file.delete()</code> does not securely delete.</p>
</li>
<li>
<p>Always delete cache files when user logs out</p>
</li>
<li>
<p>Do not keep files with any sensitive data any longer than absolutely needed.</p>
</li>
<li>
<p>Do not create files with MODE_WORLD_READABLE or writeable</p>
</li>
<li>
<p>Do not use modes such as 0666, 0777, 0663 with chmod binary or syscalls accepting a file modes</p>
</li>
<li>
<p>Only share info using content providers instead of file system</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cryptography">Cryptography</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dont store plain-text secret key</p>
</li>
<li>
<p>Never roll your own CRYPTO libraries. use the approved ones</p>
</li>
<li>
<p>Never store secrets using string - only char[] and byte[]</p>
</li>
<li>
<p>Never seed SecureRandom</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_camera_feed">Camera feed</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use default CAmera app/services</p>
</li>
<li>
<p>Or, create SurfaceView to display a Camera Preview and click button to convert to Picture</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_url_connections">URL Connections</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use TLS instead of SSLv3.</p>
</li>
<li>
<p>Use only https</p>
</li>
<li>
<p>SSLSocket class can be used but with caution. It does not do hostname verification.</p>
</li>
<li>
<p>If overriding, check <code>getDefaultHostNameVerifier()</code> or <code>HostNameVerifier.verify()</code> returns boolean true.</p>
</li>
</ol>
</div>
</div></p>
			</div>
			<div id="push"></div>
		</div>

    <hr/>
<div id="footer">
    <p class="muted credit">&copy; 2005-2016 | Senthilkumar Gopal. The opinions expressed here are my own and do not reflect the opinions of my employer. The source code for this site is publicly available at <a href="https://github.com/sengopal/sengopal.github.com">github</a></p>
</div>

<script src="../js/jquery-1.11.1.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/highlight.min.js"></script>

<script type="text/javascript">
	  $(function() {
	    hljs.tabReplace = '  '; //4 spaces
	    hljs.initHighlighting();
	  });
</script>

	</body>
</html>
